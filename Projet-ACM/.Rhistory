for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
for( col_name in colnames(Dataset))
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col],centers = j,nstart = 5)
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
j=2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
write.csv(new_Dataset,"CPM.csv")
kmeans(Dataset[col_name],centers = j,nstart = 5)
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
j=1
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col],centers = j,nstart = 5)
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
j=2
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
j=2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
j=2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
getwd()
write.csv(new_Dataset,"CPM.csv")
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
j=1
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
while(x$betweenss/x$totss<.5)
{
j=j+1
x = kmeans(Dataset[col_name],centers = j,nstart = 5)
}
t=paste(col_name,"_edited",sep="")
new_Dataset["Taux",t]=x$betweenss/x$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name]=paste(col_name,x$centers[x$cluster[i-1]],sep=":")
new_Dataset[i,t]=x$centers[x$cluster[i-1]]
}
print(c(col_name,j,x$betweenss/x$totss))
}
write.csv(new_Dataset,"CPM.csv")
strd = "agbd"
strd
strd = "agbd"+1
strd = strd + " kejgfv"
# Lecture du jeu de données
Dataset = read.csv2("Data_for_UCI_named.csv")
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
n = 2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
t = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", t] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,t] = kmean$centers[kmean$cluster[i-1]]
}
print(c(col_name,n , kmean$betweenss/kmean$totss))
}
write.csv(new_Dataset,"Data_for_UCI_named_New.csv")
# Lecture du jeu de données
Dataset = read.csv2("Data_for_UCI_named.csv")
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
n = 2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
print(c(col_name,n , kmean$betweenss/kmean$totss))
}
write.csv(new_Dataset,"Data_for_UCI_named_New.csv")
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
result      = data.frame()
n = 2
iter = 1
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result[iter] <- c(col_name,n , kmean$betweenss/kmean$totss)
iter <- iter + 1
}
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result[iter] <- c(col_name,n , kmean$betweenss/kmean$totss)
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result.Newdf <- rbind(col_name,n , kmean$betweenss/kmean$totss)
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result.Newdf <- rbind(col_name,n , kmean$betweenss/kmean$totss)
}
result
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result.Newdf <- c(col_name,n , kmean$betweenss/kmean$totss)
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
result      = data.frame()
n = 2
iter = 1
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result.Newdf <- c(col_name,n , kmean$betweenss/kmean$totss)
}
result
# print(c(col_name,n , kmean$betweenss/kmean$totss))
result.Newdf <- data.frame(col_name,n , kmean$betweenss/kmean$totss)
result
# Discretization en 3 classes pour chaque variable.
new_Dataset = data.frame()
data_frame  = data.frame()
result      = data.frame()
n = 2
iter = 1
n = 2
for( col_name in colnames(Dataset))
{
new_Dataset["Taux",col_name] = 0
for(i in 1:nrow(Dataset)+1)
{
new_Dataset[i,col_name]=Dataset[i,col_name]
}
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
while(kmean$betweenss/kmean$totss<.5)
{
n = n + 1
kmean = kmeans(Dataset[col_name],centers = n, nstart = 5)
}
current = paste(col_name,"_Modifié",sep="")
new_Dataset["Taux", current] = kmean$betweenss/kmean$totss
for(i in 1:nrow(Dataset)+1)
{
data_frame[i-1,col_name] = paste(col_name,kmean$centers[kmean$cluster[i-1]],sep=":")
new_Dataset[i,current] = kmean$centers[kmean$cluster[i-1]]
}
print(c(col_name,n , kmean$betweenss/kmean$totss))
}
write.csv(new_Dataset,"Data_for_UCI_named_New.csv")
#2 Construction du tableau disjonctif complet
Tabl_Disj_Com <- tab.disjonctif(data_frame)
#2 Construction du tableau disjonctif complet
library(FactoMineR)
Tabl_Disj_Com <- tab.disjonctif(data_frame)
# Construction du tableau disjonctif complet
# Transformation des nombres en facteurs pour construire le tableau disjonctif;
k=0
while(k < ncol(data_frame))
{
k=k+1
data_frame[,k] = as.factor(data_frame[,k])
}
ncol(data_frame)
Dataset = data_frame
Dataset
{
k=k+1
data_frame[,k] = as.factor(data_frame[,k])
}
Dataset = data_frame
# Construction du tableau disjonctif complet
Tabl_Disj_Com <- tab.disjonctif(data_frame)
Tabl_Disj_Com
write.csv(Tabl_Disj_Com,"Tableau_Disjonctif_Complet.csv")
# Calcul de la fréquence de chaque modalité
Freq_Mod = apply(Tabl_Disj_Com,2,sum)/(nrow(Tabl_Disj_Com))
Freq_Mod
# Application de l'ACM au tableau disjonctif complet
library(FactoMineR)
ACM < -MCA(Dataset, graph=FALSE)
ACM < -MCA(Dataset, graph=FALSE)
# Application de l'ACM au tableau disjonctif complet
library(FactoMineR)
ACM < -MCA(data_frame, graph=FALSE)
ACM <- MCA(data_frame, graph=FALSE)
ACM
print(ACM)
ACM
# Les valeurs propres, le pourcentage d’inertie de chaque valeur propre ainsi que le cumul des pourcentages d’inertie.
Valeur_Propres = ACM$eig
print(Valeur_Propres)
#6 le graphique des valeurs propres
windows(10, 10)
#6 le graphique des valeurs propres
windows(1, 1)
par(mfrow=c(1,1))
barplot(Valeur_Propres[,1], main= "Histogramme des valeurs propres",
names.arg=rownames(ACM$eig),
xlab= "Axes",
ylab= "Pourcentage d'inertie", cex.axis=0.8)
#6 le graphique des valeurs propres
par(mfrow=c(1,1))
barplot(Valeur_Propres[,1], main= "Histogramme des valeurs propres",
names.arg=rownames(ACM$eig),
xlab= "Axes",
ylab= "Pourcentage d'inertie", cex.axis=0.8)
# Calcul du cos2 des modalités
Cos2_Modalite = ACM$var$cos2
print(Cos2_Modalite)
# Distinction des modalités bien, moyennement et faiblement représentées sur le sous espace
library(corrplot)
par(mfrow=c(1,1))
corrplot(Cos2_Modalite[,1:2], is.corr=FALSE)
# Calcul de la contribution des modalités
Contribution_Modalite = ACM$var$contrib
print(Contribution_Modalite)
# Application de la CAH au tableau des contributions des modalités
write.table(Contribution_Modalite,"Contribution_Modalite.csv",
sep=";",
col.names=TRUE,
dec=',',
row.names=TRUE)
Data_Cont_Mod = read.csv2("Contribution_Modalite.csv",row.names=1)
Data_Cont_Mod
View(Data_Cont_Mod)
CAH <- HCPC(Data_Cont_Mod, graph = FALSE)
windows(10, 10)
par(mfrow=c(1,1))
plot(CAH, choice = "tree")
# Tracer le nuage des modalités projeté sur les 2 premiers axes.
plot(CAH, axes = c(1, 2))
# Calcul du cos2 des individus
Cos2_Individus = ACM$ind$cos2
print(Cos2_Individus)
# Calcul de la contribution des modalités
Contribution_Individus = ACM$ind$contrib
print(Contribution_Individus)
# Application de la CAH au tableau des contributions des individus
write.table(Contribution_Individus,"Contribution_Individus.csv",
sep=";",
col.names=TRUE,
dec=',',
row.names=TRUE)
Contribution_Individus = read.csv2("Contribution_Individus.csv.",row.names=1)
getwd
getwd()
# Application de la CAH au tableau des contributions des individus
write.table(Contribution_Individus,"Contribution_Individus.csv",
sep=";",
col.names=TRUE,
dec=',',
row.names=TRUE)
Contribution_Individus = read.csv2("Contribution_Individus.csv.",row.names=1)
Contribution_Individus = read.csv2("Contribution_Individus.csv",row.names=1)
CAH <- HCPC(Contribution_Individus, graph = FALSE)
plot(cah.ind, choice = "tree")
CAH_Individus <- HCPC(Contribution_Individus, graph = FALSE)
plot(CAH_Individus, choice = "tree")
# Calcul des coefficients de corrélation des variables
ACM$var$eta2
# Graphique des coefficients de corrélation
library(ade4)
install.packages("ade4")
# Graphique des coefficients de corrélation
library(ade4)
plot(ACM$var$eta2, boxes = FALSE)
