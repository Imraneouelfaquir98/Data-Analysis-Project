getwd()
Ventes<-read.csv2("Ventes.csv")
Ventes<-read.csv2("/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Ventes.csv")
str(Ventes)
Don<-Ventes[,2:10]
library(FactoMineR)
#calcul des corr?lations entre variables
cor(Don)
#Test de sphéricité de Bartlett
bartlett.test(Don)
#Calcul de l'indice KMO et des MSAi
library(psych)
install.packages('psych')
#Calcul de l'indice KMO et des MSAi
library(psych)
KMO(cor(Don))
#Application de l'ACP
res<-PCA(Don,ncp=5,axes=c(1,2))
attributes(res)
#Calcul des valeurs propres de la matrice de corrélation
res$eig
#Graphique des valeurs propres
plot(1:9,res$eig[,1],type="b",ylab="Valeurs propres",xlab="Composantes",main="graphique des valeurs propres")
sum(res$eig[,1])
#discr?tisation des valeurs propres par kmeans
vp<-res$eig[,1]
inertie.expl <- rep(0,times=8)
for (k in 2:8){
clus <- kmeans(vp,centers=k,nstart=5)
inertie.expl[k] <- clus$betweenss/clus$totss
}
#graphique
plot(1:8,inertie.expl,type="b",xlab="Nb. de groupes",ylab="% inertie expliqu?e")
write.table(vp,"Valeurs propres.csv",sep=",",col.names=TRUE,dec=',', row.names=FALSE)
#Nuages des variables
#Calcul de : coord, cor, cos2, contrib
res$var
#Cumul des cos2
print(t(apply(res$var$cos2,1,cumsum)),digit=2)
#Contribution des variables au sous espace
cont<-res$var$contrib
write.table(cont,"Cont_Var.csv",sep=";",col.names=TRUE,dec=',', row.names=TRUE)
Don<-read.csv2("Cont_varBis.csv",row.names=1)
write.table(cont,"/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Cont_Var.csv",sep=";",col.names=TRUE,dec=',', row.names=TRUE)
Don<-read.csv2("/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Cont_varBis.csv",row.names=1)
write.table(cont,"/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Cont_Var.csv",sep=";",col.names=TRUE,dec=',', row.names=TRUE)
Don<-read.csv2("/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Cont_varBis.csv",row.names=1)
Don<-read.csv2("/home/imrane/Desktop/Analyse de données/ACP/ACP Ventes/Cont_VarBis.csv",row.names=1)
Don$var <- as.character(Don$var)
Cat_var<-HCPC(Don)
